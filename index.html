<!DOCTYPE html>
<html lang="zh"><head id="jifkcciiigbfigfcehmmoaomdjdngceo"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="keywords" content="婉莹,网友记录,网红美少女">
    <meta name="description" content="我们有精心筛选的作品，为老哥个性化推荐，老哥社区交流，探索无尽作品。即刻启程，开启属于您的作品冒险">
    <link href="/favicon.ico?v=1.1.7" rel="icon">
    <link rel="stylesheet" href="/bootstrap.min.css">
    <link rel="stylesheet" href="/font-awesome.min.css">
    <link rel="stylesheet" href="/i.css">
    <script src="/cooooo.js"></script>
    <script src="/jquery.min.js"></script>
    <script src="/jquery.sliderBar.js"></script>
    <script src="/layer.js"></script><link rel="stylesheet" href="/layer.css" id="layuicss-layer">
    <script src="/clipboard.js"></script>
    <title>洛丽汇-快乐屋</title>
    <!--start::HOOK-->
    
    
    <!--end::HOOK-->
</head>
<body style="background: url(&#39;/assets/admin/images/login/bg.jpg&#39;) fixed no-repeat;background-size: cover;">
<div id="app">
    <nav class="navbar navbar-expand-lg navbar-light bg-light" style="background-color: rgba(255,255,255,0.85) !important;">
        <div class="container">
           <div class="navbar-brand">
               <a href="/">
                   <img src="/favicon.ico" height="30px" style="border-radius: 50%;box-shadow: #f0d1d4 1px 1px 1px;">
                    <span style="position: relative;top: 4px;left: 3px;font-weight: bold;color: #1396558a;">  洛丽汇-快乐屋</span></a>
                  <a href="/user/authentication/login?goto=/"><span style="position: relative;top: 4px;left: 10px;font-size: 18px;color: #79b9fbbd;font-weight: bold;"><i class="fa fa-sign-in"></i> 登录</span></a>            </div>
            <div class="row">
                <a class="nav-link" href="/" style="font-weight: bolder;"><i class="fa fa-shopping-cart" aria-hidden="true"></i>首页</a>
                <a class="nav-link" href="/user/index/query" style="font-weight: bolder;"><i class="fa fa-search-plus" aria-hidden="true"></i> 查作品</a>
                                        </div>
            <!--<div class="navbar-collapse">
                <ul class="navbar-nav mr-auto"></ul>
            </div>-->
        </div>
    </nav>
<div class="content-wrapper">
    <div class="container">

        <!--            公告部分-->
        <div class="card">
            <div class="card-header">
                <p class="card-title"><i class="fa fa-bullhorn" aria-hidden="true"></i> 公告</p>
            </div>
            <div class="card-block">
                <p>洛丽汇-快乐屋</p>
            </div>
        </div>


        <!--            选择作品部分-->
        <div class="card">
            <div class="card-header">
                <p class="card-title"><i class="fa fa-gratipay" aria-hidden="true"></i>收录</p>
            </div>
            <div class="card-block">
                <fieldset class="form-group">
                    <label for="type" style="font-size: 14px;">所有分类</label>
                    <div id="type" class="category">
                    <span class="category--10 button-click category-button checked" onclick="getCommodity(this,-10)"><img class="commodity-icon" src="/recommend.png"> <b style="color: #ef783b;">推荐</b></span><span class="category-2 button-click category-button " onclick="getCommodity(this,2)"><img class="commodity-icon" src="/favicon.ico"> 网红美少女</span><span class="category-3 button-click category-button " onclick="getCommodity(this,3)"><img class="commodity-icon" src="/favicon.ico"> 海外</span><span class="category-4 button-click category-button " onclick="getCommodity(this,4)"><img class="commodity-icon" src="/favicon.ico"> 国内</span><span class="category-1 button-click category-button " onclick="getCommodity(this,1)"><img class="commodity-icon" src="/favicon.ico"> 其他</span><span class="category-6 button-click category-button " onclick="getCommodity(this,6)"><img class="commodity-icon" src="/favicon.ico"> 精选</span></div>
                </fieldset>

                <fieldset class="form-group product" style="">
                    <label for="product" style="font-size: 14px;">点击即选择</label>
                    <div id="product"><span class="button-click commodity-250" onclick="getCommodityInfo(this,250)"><img class="commodity-icon" src="/favicon.ico"> 一树梨花压海棠</span><span class="button-click commodity-210" onclick="getCommodityInfo(this,210)"><img class="commodity-icon" src="/favicon.ico"> 我本初中一原版全集《83G》</span><span class="button-click commodity-211" onclick="getCommodityInfo(this,211)"><img class="commodity-icon" src="/favicon.ico"> 二院系列（11.2GB）</span><span class="button-click commodity-212" onclick="getCommodityInfo(this,212)"><img class="commodity-icon" src="/favicon.ico"> 磁力猫的入口</span><span class="button-click commodity-215" onclick="getCommodityInfo(this,215)"><img class="commodity-icon" src="/favicon.ico"> 咬兔子全系有aiai《4.2G》</span><span class="button-click commodity-216" onclick="getCommodityInfo(this,216)"><img class="commodity-icon" src="/favicon.ico"> 陈苏霖系列（16.5GB）</span><span class="button-click commodity-217" onclick="getCommodityInfo(this,217)"><img class="commodity-icon" src="/favicon.ico"> LOIBUS入口</span><span class="button-click commodity-218" onclick="getCommodityInfo(this,218)"><img class="commodity-icon" src="/favicon.ico"> luoli.info</span><span class="button-click commodity-219" onclick="getCommodityInfo(this,219)"><img class="commodity-icon" src="/favicon.ico"> 洛丽汇-精选</span><span class="button-click commodity-220" onclick="getCommodityInfo(this,220)"><img class="commodity-icon" src="/favicon.ico"> 海安幼儿园《2.81G》</span><span class="button-click commodity-225" onclick="getCommodityInfo(this,225)"><img class="commodity-icon" src="/favicon.ico"> 贫乳r15-系列</span><span class="button-click commodity-226" onclick="getCommodityInfo(this,226)"><img class="commodity-icon" src="/favicon.ico"> 萌萝社的入口</span><span class="button-click commodity-231" onclick="getCommodityInfo(this,231)"><img class="commodity-icon" src="/favicon.ico"> 亚洲萝呦论坛网</span><span class="button-click commodity-233" onclick="getCommodityInfo(this,233)"><img class="commodity-icon" src="/favicon.ico"> 小熊社mum全套作品</span><span class="button-click commodity-236" onclick="getCommodityInfo(this,236)"><img class="commodity-icon" src="/favicon.ico"> 神秘的入口</span><span class="button-click commodity-237" onclick="getCommodityInfo(this,237)"><img class="commodity-icon" src="/favicon.ico"> u15少女偶像写真视频系列（132GB）</span><span class="button-click commodity-239" onclick="getCommodityInfo(this,239)"><img class="commodity-icon" src="/favicon.ico"> 椎名桃子的所有作品珍藏</span><span class="button-click commodity-240" onclick="getCommodityInfo(this,240)"><img class="commodity-icon" src="/favicon.ico"> youyoua的幼幼</span><span class="button-click commodity-243" onclick="getCommodityInfo(this,243)"><img class="commodity-icon" src="/favicon.ico"> 快乐屋洛丽塔</span><span class="button-click commodity-244" onclick="getCommodityInfo(this,244)"><img class="commodity-icon" src="/favicon.ico"> 白丝二次元美少女萝</span><span class="button-click commodity-246" onclick="getCommodityInfo(this,246)"><img class="commodity-icon" src="/favicon.ico"> 俄罗斯洛丽塔</span><span class="button-click commodity-248" onclick="getCommodityInfo(this,248)"><img class="commodity-icon" src="/favicon.ico"> 屋次元-欢乐的屋</span></div>
                </fieldset>
            </div>
        </div>


        <!--            详细信息部分-->
        <div class="card animated shopInfoHtml" style="display: none;">
            <div class="card-header">
                <p class="card-title">详细信息</p>
            </div>
            <form class="commodity"></form>

            <div class="sliderbar-container" style="width: 105px; height: 180px; top: 5px; position: absolute; font-family: &quot;Microsoft Yahei&quot;; z-index: 9999; right: 0px;">
                <div class="title" style="width: 22px; height: 135px; position: absolute; top: -1px; display: block; background-color: rgb(241, 163, 176); font-size: 13px; padding: 8px 4px 0px 5px; color: rgb(255, 255, 255); cursor: pointer; border-radius: 5px; font-weight: bold; right: -25px;"><i class="fa fa-chevron-circle-left" style="font-size: 15px;"></i> 联系客服</div>
                <div class="body" style="width: 105px; height: 180px; position: relative; padding: 10px; overflow: hidden auto; font-family: &quot;Microsoft Yahei&quot;; font-size: 12px; background-color: rgba(255, 255, 255, 0.72); display: none; border-radius: 5px; font-weight: bold;">
                    <div style="margin-bottom: 10px;"><img src="/favicon.ico" alt="" style="border-radius: 100%;height: 28px;" class="service-avatar"> <span style="color: #e093ff;position: relative;top: 1px;" class="service-nickname">自助平台无客服!</span>
                    </div>
                    <a class="button-click service-url" style="line-height: 22px;margin-right: 0;color: #ff8888;" target="_blank"><i class="fa fa-user-plus"></i> 点击返回</a>

                </div>
            </div>
        </div>

        <!--            指定获取部分-->
        <div class="card animated specified" style="display: none;">
            <div class="card-header">
                <p class="card-title"></p>
            </div>
            <div class="card-block anticipation">
            </div>
        </div>


        <!--            获取部分-->
        <div class="card animated fadeInLeft" style="display: none;">
            <div class="card-header">
                <p class="card-title">获取方式</p>
            </div>
            <div class="card-block">
                <div class="login-display" style="text-align: center;font-weight: bold;margin: 10px 0 20px 0;font-size: 18px;color: #00A3FF;display: none;">
                    该作品需要登录才能获取，<a class="login-url" href="/user/authentication/login?goto=/">现在登录</a></div>
                <div class="row pay_type" style="margin-left: 0px;"> <a class="button-click" onclick="Trade(4)" style="line-height: 22px;"> <img src="/202311270927558250195.png" class="commodity-icon"> 微信</a></div>
            </div>
        </div>


    </div>
</div>
</div>

<script>
    const setting_cache = 0;
    const setting_cache_expire = 60;

    let commodityHtml = '<div class="card-block">\n' +
        '                    <div class="row">\n' +
        '                        <div class="col-md-5 description"></div>\n' +
        '                        <div class="col-md-7">\n' +
        '                            <h4 class="productName" style="margin-bottom: 10px;"></h4>\n' +
        '                            <p><span style="color: #0C84D1;font-size: 14px;cursor: pointer;" class="clipboard" data-clipboard-text=""><i class="fa fa-share"></i> 将此页分享给好友</span></p>\n' +
        '                            <p style="display: none;" class="seckill_status">限时秒杀： <span class="text-danger seckill"></span></p>\n' +
        '                            <p>结算结果： <span class="text-success price"></span></p>\n' +
        '                            <p>传递方式： <span class="badge badge-pill text-white cardType"></span></p>\n' +
        '                            <fieldset class="form-group">\n' +
        '                                <label style="display: inline-block;">联系方式：</label>\n' +
        '                                <input class="form-control round contact" name="contact" placeholder="">\n' +
        '                            </fieldset>\n' +
        '                            <fieldset class="form-group fieldset-password" style="display: none;">\n' +
        '                                <label style="display: inline-block;">查询密码：</label>\n' +
        '                                <input class="form-control round password" name="password" type="password"\n' +
        '                                       placeholder="请设置您的订单查询密码(6位以上)">\n' +
        '                            </fieldset>\n' +
        '                            <fieldset class="form-group voucher-view" style="display: none;">\n' +
        '                                <label style="display: inline-block;">神秘代码：</label>\n' +
        '                                <input class="form-control round voucher" onchange="getTradeAmount()" name="coupon"\n' +
        '                                       placeholder="如果您有神秘代码可以填神秘代码，没有可不填写">\n' +
        '                            </fieldset>\n' +
        '                            <fieldset class="form-group race-view" style="display: none;">\n' +
        '                                <label style="display: inline-block;">选择种类：</label>\n' +
        '                                 <span class="race-list"></span>\n' +
        '                            </fieldset>\n' +
        '                            <fieldset class="form-group">\n' +
        '                                <label>选择数量：</label>\n' +
        '                                <input class="form-control round buyNum" onchange="getTradeAmount()" name="num"\n' +
        '                                       type="number" style="width: 10%;" value="1">\n' +
        '                                <span style="margin-left: 10px;display: none;" class="kucunView"> 剩余库存: <span\n' +
        '                                        class="badge badge-pill badge-success text-white card_count">0</span></span>\n' +
        '                            </fieldset><p class="widget"></p>\n' +
        '                            <p><span class="purchase_count" style="font-size: 14px;font-weight: bold;color: #c59de9;display: none;"></span></p>\n' +
        '                            \n' +
        '                            <fieldset class="form-group">\n' +
        '                                <label>人机验证：</label>\n' +
        '                                <input class="form-control round captcha" name="captcha" type="text" style="width: 15%;"\n' +
        '                                       value="">\n' +
        '                                <span style="margin-left: 10px;"><img\n' +
        '                                    class="captchaImage"\n' +
        '                                        style="margin-top: -3px;cursor: pointer;" src="/user/captcha/image?action=trade"\n' +
        '                                        alt="验证码"></span>\n' +
        '                            </fieldset>\n' +
        '                            \n' +
        '                            <p style="" class="payAmountView">结算结果： <span><b style="font-size:16px;color: #f757b7;font-weight: bold;" class="payAmount"></b></span></p>\n' +
        '                            <fieldset class="form-group wholesale" style="display: none;">\n' +
        '                                <div style="font-size: 12px;color: #ff5aa6;font-weight: bold;"\n' +
        '                                     class="wholesaleHtml"></div>\n' +
        '                            </fieldset>\n' +
        '                        </div>\n' +
        '                    </div>\n' +
        '                </div>';
    let switchElement = function (obj) {
        $('.checked').removeClass('checked');
        $(obj).addClass('checked');
    };

    let productInstance = $('#product');
    let globalCommodityId = 0;
    let globalRaceId = "";
    let seckillPid = 0;
    let defaultCategory = "-10";
    let defaultCommodity = "";
    let draftStatus = 0;
    let inventoryHidden = 0;

    //-----------------------------------获取分类------------------------------------------
    Pay.getCategory(list => {
        list.forEach(category => {
            $(".category").append('<span class="category-' + category.id + ' button-click category-button ' + (category.commodity_count == 0 ? 'empty-commodity' : '') + '" ' + (category.commodity_count == 0 ? '' : 'onclick="getCommodity(this,' + category.id + ')"') + '>' + (category.icon ? '<img class="commodity-icon" src="' + category.icon + '">' : '') + ' ' + category.name + '</span>');
        });
        if (defaultCategory) {
            $('.category-' + defaultCategory).click(); //自动点击分类
            defaultCategory = null;
        }
    });

    //-----------------------------------获取作品------------------------------------------
    function getCommodity(obj, categoryId) {
        switchElement(obj);
        $('.shopInfoHtml').hide(150);
        $('.fadeInLeft').hide(150);
        $('.specified').hide(150);

        Pay.getCommodityAll(categoryId, list => {
            $('.product').hide(150);
            productInstance.html("");
            if (list.length === 0) {
                layer.msg("该分类下没有作品");
                return;
            }
            $('.product').show(150);
            list.forEach(item => {
                productInstance.append('<span class="button-click commodity-' + item.id + '" onclick="getCommodityInfo(this,' + item.id + ')" ' + ((item.card_count == 0 && item.delivery_way == 0 && !item.shared) ? 'style="background-color: #ced4dadb;opacity: 0.6;"' : '') + '>' + (item.cover ? '<img class="commodity-icon" src="' + item.cover + '">' : '') + ' ' + item.name + '</span>');
            });

            if (defaultCommodity) {
                $('.commodity-' + defaultCommodity).click(); //自动点击作品
                defaultCommodity = null;
            }
        })
    }


    //-----------------------------------获取预选账号--------------------------------------
    function checkbox(obj) {
        let state = $(obj).prop("checked");
        $('input[name=card_id]:checked').prop("checked", false);
        if (state === true) {
            $(obj).prop("checked", true);
        } else {
            $(obj).prop("checked", false);
        }
    }

    function getDraftCard(commodityId, page) {
        Pay.getDraftCard(commodityId, page, globalRaceId, res => {
            let next = res.current_page + 1;
            let prev = res.current_page - 1;
            if (next >= res.last_page) {
                next = res.last_page;
            }
            if (prev <= 1) {
                prev = 1;
            }
            $('.anticipation').show(150);
            $('.anticipation').html('<table><thead><tr><th><button ' + (res.current_page <= 1 ? 'disabled' : '') + ' type="button" onclick="getDraftCard(' + commodityId + ',' + prev + ')">上一页</button> <button ' + (res.current_page >= res.last_page ? 'disabled' : '') + ' type="button" onclick="getDraftCard(' + commodityId + ',' + next + ')">下一页</button></th></tr></thead><tbody class="draftCard"></tbody></table>');

            if (res.data.length == 0) {
                $('.draftCard').append('<tr><td style="text-align: center;">暂无数据</td></tr>');
                return;
            }

            res.data.forEach(item => {
                $('.draftCard').append('<tr><td><label><input type="checkbox" onclick="getTradeAmount()" onchange="checkbox(this)" name="card_id" value="' + item.id + '"> ' + item.draft + '</label></td></tr>');
            });
        });
    }

    //-----------------------------------获取作品详情--------------------------------------

    function getCommodityInfo(obj, commodityId) {
        $('.shopInfoHtml').hide(150);
        $('.fadeInLeft').hide(150);
        $('.specified').hide(150);
        $('.commodity').html("");
        $('.login-display').hide();
        $('.pay_type').show();

        globalRaceId = "";
        globalCommodityId = commodityId;
        switchElement(obj);
        Pay.getCommodityDetail(commodityId, commodity => {
            $('.service-qq').attr("href", "https://wpa.qq.com/msgrd?v=1&uin=" + commodity.service_qq);
            $('.service-url').attr("href", commodity.service_url);

            if (commodity.owner) {
                $('.service-avatar').attr("src", commodity.owner.avatar);
                $('.service-nickname').css({"color": "#ff00e0a1"}).html(commodity.owner.username);
            } else {
                $('.service-avatar').attr("src", "/favicon.ico");
                $('.service-nickname').css({"color": "#e093ff"}).html("自助平台无客服！");
            }

            $('.commodity').html(commodityHtml);
            $('.shopInfoHtml').show(150);
            $('.fadeInLeft').show(150);

            $('.productName').html(commodity.name);
            $('.description').html(commodity.description);

            if (commodity.minimum > 0) {
                $('.buyNum').val(commodity.minimum).change();
            }


            $('.description').find("img").click(function () {
                let imageUrl = $(this).attr("src");

                let img = new Image()
                img.src = imageUrl;
                img.onload = function () {
                    if (img.width >= window.innerWidth) {
                        img.width = window.innerWidth * 0.9;
                    }

                    if (img.height >= window.innerHeight) {
                        img.height = window.innerHeight * 0.9;
                    }

                    // 打印
                    layer.open({
                        type: 1,
                        title: false,
                        closeBtn: 0, //不显示关闭按钮
                        anim: 5,
                        area: [img.width + "px", img.height + "px"],
                        shadeClose: true, //开启遮罩关闭
                        content: '<img  src="' + imageUrl + '" style="width:' + img.width + 'px;height:' + img.height + 'px">'
                    });
                }
            });

            //限时秒杀
            clearInterval(seckillPid);
            if (commodity.seckill_status == 1) {
                $('.seckill_status').show();
                let seckillStartTime = new Date(commodity.seckill_start_time).getTime();
                let seckillEndTime = new Date(commodity.seckill_end_time).getTime();
                var nowTime = new Date().getTime();

                let fnEnd = () => {
                    let langTime = Pay.getLangTime(new Date().getTime(), seckillEndTime);
                    $('.seckill').html("<b style='color: #0fb183;'>还剩" + langTime.days + "天" + langTime.hours + "时" + langTime.minutes + "分" + langTime.seconds + "秒结束</b>");
                    if (langTime.days <= 0 && langTime.hours <= 0 && langTime.minutes <= 0 && langTime.seconds <= 0) {
                        $('.seckill').html("<b style='color: #9d9d9d;'>已结束</b>");
                        $('.fadeInLeft').hide();
                        clearInterval(seckillPid);
                    }
                };
                let fnStart = () => {
                    let langTime = Pay.getLangTime(new Date().getTime(), seckillStartTime);
                    $('.seckill').html("<b style='color: #e22727;'>" + langTime.days + "天" + langTime.hours + "时" + langTime.minutes + "分" + langTime.seconds + "秒后开始抢购</b>");
                    if (langTime.days <= 0 && langTime.hours <= 0 && langTime.minutes <= 0 && langTime.seconds <= 0) {
                        clearInterval(seckillPid);
                        $('.fadeInLeft').show();
                        fnEnd();
                        seckillPid = setInterval(fnEnd, 1000);
                    }
                };

                if (nowTime >= seckillStartTime && nowTime <= seckillEndTime) {
                    $('.fadeInLeft').show();
                    fnEnd();
                    //秒杀正在进行当中
                    seckillPid = setInterval(fnEnd, 1000);
                } else if (nowTime < seckillStartTime) {
                    $('.fadeInLeft').hide();
                    fnStart();
                    seckillPid = setInterval(fnStart, 1000);
                } else if (nowTime > seckillEndTime) {
                    $('.fadeInLeft').hide();
                    $('.seckill').html("<b style='color: #9d9d9d;'>已结束</b>");
                }

            }

                        let user = "";
            if (commodity.user_price < commodity.price) {
                user = '<span class="price_tips">(会员:¥' + commodity.user_price + ') <a style="color: #6d97d5;" href="/user/authentication/login" target="_blank">现在就去登录!</a></span>';
            }
            $('.price').html('¥' + commodity.price + ' ' + user);
            $('.payAmount').html("¥" + commodity.price);

            //未登录
            //判断是否需要登录才能获取作品
            if (commodity.only_user == 1 || commodity.purchase_count > 0) {
                $('.login-url').attr("href", "/user/authentication/login?goto=" + encodeURIComponent(commodity.share_url));
                $('.login-display').show();
                $('.pay_type').hide();
            }
                        inventoryHidden = commodity.inventory_hidden;
            if (commodity.delivery_way === 0) {
                $('.cardType').html("自动发货").addClass("badge-success");
                $('.kucunView').show();
                if (commodity.inventory_hidden == 1) {
                    if (commodity.card <= 0) {
                        $('.card_count').removeClass("badge-success").addClass("badge-dark").html("已公开");
                    } else if (commodity.card <= 5) {
                        $('.card_count').removeClass("badge-success").addClass("badge-danger").html("即将公开");
                    } else if (commodity.card <= 20) {
                        $('.card_count').removeClass("badge-success").addClass("badge-warning").html("一般");
                    } else if (commodity.card > 20) {
                        $('.card_count').html("充足");
                    }
                } else {
                    $('.card_count').html(commodity.card);
                }

            } else {
                $('.cardType').html("在线发货").addClass("badge-danger");
            }

            let contactType = ["任意联系方式", "手机号", "邮箱", "QQ号"];

            $('.contact').attr("placeholder", "请输入您的" + contactType[commodity.contact_type] + "，方便以后查询");

            if (commodity.login) {
                $('.contact').parent().hide();
            }

            //
            if (commodity.password_status === 1 && !commodity.login) {
                $('.fieldset-password').show();
            }


            if (commodity.coupon === 1) {
                $('.voucher-view').show();
            }

            if (commodity.purchase_count > 0) {
                $('.purchase_count').html("该作品每人累计获取最多" + commodity.purchase_count + "个");
                $('.purchase_count').show();
            }

            //控件
            if (commodity.widget) {
                let parse = JSON.parse(commodity.widget);
                if (parse != null) {
                    parse.forEach(widget => {
                        if (widget.type == "text" || widget.type == "password" || widget.type == "number") {
                            $('.widget').append('<fieldset class="form-group"><label style="display: inline-block;">' + widget.cn + '：</label><input type="' + widget.type + '" class="form-control round" name="' + widget.name + '" placeholder="' + widget.placeholder + '"></fieldset>');
                        } else if (widget.type == "select") {
                            let html = '<fieldset class="form-group"><label style="display: inline-block;">' + widget.cn + '：</label><select name="' + widget.name + '" style="border-radius: 5px;border: 1px dashed #80b9f594;width:auto;height: auto;display: inline-block;padding: 0 0;"><option value="">' + widget.placeholder + '</option>';
                            let dict = widget.dict.split(",");
                            for (let i = 0; i < dict.length; i++) {
                                let sp = dict[i].split("=");
                                if (sp.length != 2) {
                                    continue;
                                }
                                html += '<option value="' + sp[1] + '">' + sp[0] + '</option>'
                            }
                            html += "</select></fieldset>"
                            $('.widget').append(html);
                        } else if (widget.type == "textarea") {
                            $('.widget').append('<fieldset class="form-group"><textarea name="' + widget.name + '" placeholder="' + widget.placeholder + '" style="border-radius: 5px;border: 1px dashed #80b9f594;width: 100%;height: 100px;"></textarea></fieldset>');
                        } else if (widget.type == "checkbox") {
                            let html = '<fieldset class="form-group"><label style="display: inline-block;">' + widget.cn + '：</label>';
                            let dict = widget.dict.split(",");
                            for (let i = 0; i < dict.length; i++) {
                                let sp = dict[i].split("=");
                                if (sp.length != 2) {
                                    continue;
                                }
                                html += '<label style="margin-right: 10px;"><input name="' + widget.name + '[]" type="checkbox" value="' + sp[1] + '"> ' + sp[0] + '</label>';
                            }
                            html += '</fieldset>';
                            $('.widget').append(html);
                        } else if (widget.type == "radio") {
                            let html = '<fieldset class="form-group"><label style="display: inline-block;">' + widget.cn + '：</label>';
                            let dict = widget.dict.split(",");
                            for (let i = 0; i < dict.length; i++) {
                                let sp = dict[i].split("=");
                                if (sp.length != 2) {
                                    continue;
                                }
                                html += '<label style="margin-right: 10px;"><input name="' + widget.name + '" type="radio" value="' + sp[1] + '"> ' + sp[0] + '</label>';
                            }
                            html += '</fieldset>';
                            $('.widget').append(html);
                        }

                    });
                }
            }


            $('.clipboard').attr("data-clipboard-text", commodity.share_url);

            $('.clipboard').click(function () {
                var clipboard = new ClipboardJS(".clipboard");
                clipboard.on('success', function (e) {
                    layer.msg("分享链接已经复制成功了，赶快发给好友吧！")
                });
            });

            $('.captchaImage').click(function () {
                captchaImage();
            });


            //渲染作品种类
            if (commodity.hasOwnProperty('race') && commodity.race) {
                $('.race-view').show();
                let raceIndex = 0;
                for (let key in commodity.race) {
                    if (raceIndex == 0) {
                        globalRaceId = key;
                    }
                    $('.race-list').append('<span onclick="raceClick(this,\'' + key + '\')" class="race-click button-click ' + (raceIndex == 0 ? 'checked' : '') + '" style="padding: 0 8px;font-size: 14px;border-radius: 10px;">' + key + '</span>');
                    raceIndex++;
                }

                let categoryWholesale = function () {
                    //批发渲染
                    let categoryWholesale = commodity.category_wholesale;
                    if (categoryWholesale && categoryWholesale.hasOwnProperty(globalRaceId)) {
                        let rules = categoryWholesale[globalRaceId];
                        let ws = [];
                        for (const ruleKey in rules) {
                            ws[ruleKey] = rules[ruleKey];
                        }
                        let x = '';
                        ws.forEach((money, num) => {
                            x += '<div class="lot_string">一次性获取' + num + '张，单价自动调整为：<b>¥' + money + '</b></div>';
                        });
                        if (ws.length > 0) {
                            $('.wholesale').show();
                            $('.wholesaleHtml').html(x);
                        } else {
                            $('.wholesale').hide();
                        }
                    } else {
                        $('.wholesale').hide();
                    }
                }

                categoryWholesale();

                $('.race-click').click(function () {
                    categoryWholesale();
                });
            } else {
                let wholesale = commodity.wholesale;
                if (wholesale && Object.keys(wholesale).length > 0) {
                    let ws = [];
                    for (const ruleKey in wholesale) {
                        ws[ruleKey] = wholesale[ruleKey];
                    }
                    let x = '';
                    ws.forEach((money, num) => {
                        x += '<div class="lot_string">一次性获取' + num + '张，单价自动调整为：<b>¥' + money + '</b></div>';
                    });
                    if (ws.length > 0) {
                        $('.wholesale').show();
                        $('.wholesaleHtml').html(x);
                    } else {
                        $('.wholesale').hide();
                    }
                }
            }

            if (commodity.draft_status === 1) {
                draftStatus = 1;
                $('.specified').show(150);
                $('.specified .card-title').html('自选加价:<b style="color: #eba0a0;font-weight: bold;">' + commodity.draft_premium + "元</b>");
                getDraftCard(commodity.id, 1);
            } else {
                draftStatus = 0;
            }

            $('html,body').animate({
                scrollTop: 9999
            }, 'slow');
        });
    }

    function getTradeAmount() {
        let num = $('input[name=num]').val();

        if (num <= 0) {
            $('input[name=num]').val(1);
            num = 1;
        }
        let cardId = $('input[name=card_id]:checked').val();
        let coupon = $('input[name=coupon]').val();
        if (cardId === undefined) {
            cardId = 0;
        }
        Pay.getTradeAmount(globalCommodityId, coupon, cardId, num, globalRaceId, res => {
            $('.payAmount').html("¥" + res.amount);
            $('.price').html("¥" + res.price);
            if (res.hasOwnProperty("card_count")) {
                let instance = $('.card_count');
                if (inventoryHidden == 1) {
                    if (res.card_count <= 0) {
                        instance.removeClass("badge-success").addClass("badge-dark").html("已公开");
                    } else if (res.card_count <= 5) {
                        instance.removeClass("badge-success").addClass("badge-danger").html("即将公开");
                    } else if (res.card_count <= 20) {
                        instance.removeClass("badge-success").addClass("badge-warning").html("一般");
                    } else if (res.card_count > 20) {
                        instance.addClass("badge-success").html("充足");
                    }
                } else {
                    instance.html(res.card_count);
                }
            }
        });
    }

    function captchaImage() {
                $('.captchaImage').attr("src", "/user/captcha/image?action=trade&rand=" + Math.ceil(Math.random() * 100000));
            }

    function Trade(payId) {
        let cardId = $('input[name=card_id]:checked').val();
        if (cardId === undefined) {
            cardId = 0;
        }

        let arrayToObject = Pay.arrayToObject($('.commodity').serializeArray());
        arrayToObject.commodity_id = globalCommodityId;
        arrayToObject.card_id = cardId;
        arrayToObject.pay_id = payId;
        arrayToObject.device = Pay.device();
        arrayToObject.from = localStorage.hasOwnProperty("from_id") ? localStorage.getItem("from_id") : 0;
        arrayToObject.race = globalRaceId;
        Pay.trade(arrayToObject, res => {
            captchaImage();
            if (res.secret == null) {
                window.location.href = res.url;
            } else {
                //跳转个人中心
                layer.open({
                    type: 1,
                    title: "您获取的账号如下：",
                    area: Pay.isMobile() ? ["100%", "100%"] : ['420px', '420px'],
                    content: '<textarea class="layui-input" style="padding: 15px;height: 98%;width: 100%;border: none;overflow-x: hidden;">' + res.secret + '</textarea>',
                    btn: ['<span style="color:white;">查看更多信息</span>'],
                    yes: function () {
                        window.open('/user/personal/purchaseRecord?tradeNo=' + res.tradeNo);
                    }
                });
            }
        }, () => {
            captchaImage();
        });
    }

    function raceClick(obj, id) {
        switchElement(obj);
        globalRaceId = id;
        getTradeAmount();
        if (draftStatus) {
            getDraftCard(globalCommodityId, 1);
        }
    }


    Pay.getPay(res => {
        res.forEach(item => {
            if (item.handle === "#system") {
                            } else {
                $('.pay_type').append(' <a class="button-click" onclick="Trade(' + item.id + ')" style="line-height: 22px;"> <img src="' + item.icon + '" class="commodity-icon"> ' + item.name + '</a>');
            }
        })
    });

    let from = parseInt("0");
    if (from !== 0) {
        localStorage.setItem("from_id", from);
    }


    $(function () {
        if (Pay.isPc()) {
            $('.sliderbar-container').sliderBar({
                open: false,           // 默认是否打开，true打开，false关闭
                width: 105,           // body内容宽度
                height: 180,          // body内容高度
                theme: '#f1a3b0',       // 主题颜色
                position: 'left'      // 显示位置，有left和right两种
            });
        } else {
            $('.sliderbar-container').hide();
        }
    });

</script><div class="layui-layer-move" id="layui-layer-move"></div>
<div class="content-icp"></div>
<p><a href="https://luolihui.pages.dev/">洛丽汇</a></p>
<p><a href="https://tangdkw.github.io/">快乐屋</a></p>
<p><a href="https://ghfd55.github.io/">张</a></p>
<p><a href="https://loshe225.github.io/">社</a></p>
<p><a href="https://tang5522.github.io/">糖心</a></p>
<p><a href="https://hfghsaf-dojdoivjdoijfiodjfiod-mcllffol.github.io">张</a></p>
<p><a href="https://zhangwany.pages.dev">张</a></p>
<!--start::HOOK-->


<!--end::HOOK-->





</body><!--start::HOOK--><!--end::HOOK--></html>